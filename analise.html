<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Relat√≥rio de Avalia√ß√£o - Auxiliares de Farm√°cia</title>
  <style>
    :root {
      --azul-hapvida: #175fc5;
      --laranja-hapvida: #f37021;
      --cinza-bg: #f5f8fc;
      --branco: #fff;
    }
    body {
      background: var(--cinza-bg);
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }
    .container {
      background: var(--branco);
      margin: 40px 0 40px 0;
      border-radius: 18px;
      box-shadow: 0 4px 24px #0002;
      padding: 38px 32px 32px 32px;
      max-width: 600px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      color: var(--azul-hapvida);
      text-align: center;
      font-size: 2rem;
      margin-bottom: 6px;
      font-weight: 700;
    }
    label {
      font-weight: bold;
      margin-top: 14px;
      color: var(--azul-hapvida);
      display: block;
    }
    .criterio {
      margin: 24px 0 18px 0;
      background: #eaf1fb;
      border-radius: 10px;
      padding: 18px 16px 10px 16px;
      width: 100%;
    }
    .criterio h2 {
      color: var(--azul-hapvida);
      font-size: 1.1rem;
      margin: 0 0 3px 0;
    }
    .criterio em {
      font-size: 0.97rem;
      color: #555;
    }
    .pergunta {
      margin: 10px 0 0 0;
      font-size: 1rem;
      color: #222;
    }
    select, input[type="text"], textarea {
      width: 100%;
      padding: 7px;
      margin-top: 5px;
      border: 1px solid #c5d3ef;
      border-radius: 6px;
      font-size: 1rem;
      background: #fafdff;
      transition: border 0.2s;
    }
    select:focus, input[type="text"]:focus, textarea:focus {
      border: 1.5px solid var(--azul-hapvida);
      outline: none;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    button {
      padding: 12px 28px;
      font-size: 1.1rem;
      background: var(--laranja-hapvida);
      color: var(--branco);
      border: none;
      border-radius: 7px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
      box-shadow: 0 2px 6px #0001;
      min-width: 140px;
    }
    button:hover:enabled {
      background: #d65e17;
    }
    #btnDownload {
      background: var(--azul-hapvida);
    }
    #btnDownload:hover:enabled {
      background: #0f4ca8;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .faixa {
      background: #eaf1fb;
      color: #222;
      border-left: 5px solid var(--azul-hapvida);
      padding: 13px 16px;
      border-radius: 8px;
      margin-bottom: 18px;
      width: 100%;
      font-size: 1rem;
    }
    pre {
      background: #fafdff;
      padding: 16px;
      border-radius: 10px;
      font-size: 1rem;
      margin-top: 25px;
      overflow-x: auto;
      border: 1.5px solid #eaf1fb;
      color: #222;
      white-space: pre-wrap;
      word-wrap: break-word;
      min-height: 150px;
      width: 100%;
    }
    .interpretacao {
      margin: 30px 0 0 0;
      background: #fff5e6;
      border-left: 5px solid var(--laranja-hapvida);
      padding: 13px 18px;
      border-radius: 8px;
      font-size: 1rem;
      width: 100%;
      color: #333;
    }
    .botoes {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 26px;
      width: 100%;
    }
    @media (max-width: 700px) {
      .container { padding: 18px 6vw 20px 6vw; }
      pre, .faixa, .interpretacao { font-size: 0.97rem; }
      .botoes {
        flex-direction: column;
        align-items: stretch;
      }
      .botoes button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Relat√≥rio de Avalia√ß√£o</h1>
    <div class="faixa">
      <b>Instru√ß√µes:</b><br>
      Para cada pergunta, marque a op√ß√£o que melhor reflete o desempenho do auxiliar avaliado, utilizando a seguinte escala:<br>
      <b>1</b> ‚Äì Discordo Totalmente (Nunca ou quase nunca acontece) &nbsp; | &nbsp;
      <b>2</b> ‚Äì Discordo (Acontece raramente) &nbsp; | &nbsp;
      <b>3</b> ‚Äì Neutro (Acontece √†s vezes) &nbsp; | &nbsp;
      <b>4</b> ‚Äì Concordo (Acontece com frequ√™ncia) &nbsp; | &nbsp;
      <b>5</b> ‚Äì Concordo Totalmente (Sempre acontece, sem exce√ß√µes)
    </div>
    <form id="formAval">
      <label for="nome">Nome do Colaborador:</label>
      <input type="text" id="nome" required />

      <label for="setor">Setor:</label>
      <input type="text" id="setor" required />

      <!-- Crit√©rio 1 -->
      <div class="criterio">
        <h2>1. Dom√≠nio T√©cnico do Sistema e Processos</h2>
        <em>Crit√©rio: Compreens√£o das funcionalidades do sistema e dos fluxos operacionais (SAP, SIGO, SIGA).</em>
        <div class="pergunta">Demonstra dom√≠nio das funcionalidades do sistema e dos processos operacionais?
          <select id="dominio1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Consegue responder d√∫vidas dos novatos de forma clara e objetiva?
          <select id="dominio2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Ele se mant√©m atualizado sobre mudan√ßas no sistema?
          <select id="dominio3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Ele utiliza exemplos pr√°ticos para facilitar o aprendizado?
          <select id="dominio4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 2 -->
      <div class="criterio">
        <h2>2. Habilidade de Mentoria e Treinamento</h2>
        <em>Crit√©rio: Capacidade de orientar os novatos, facilitando a assimila√ß√£o das informa√ß√µes.</em>
        <div class="pergunta">Utiliza uma linguagem clara e acess√≠vel para explicar conceitos e procedimentos?
          <select id="mentoria1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Demonstra paci√™ncia e reformula explica√ß√µes quando necess√°rio?
          <select id="mentoria2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Adota demonstra√ß√µes pr√°ticas ou simula√ß√µes para facilitar o aprendizado?
          <select id="mentoria3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Adapta o treinamento ao n√≠vel de conhecimento dos novatos?
          <select id="mentoria4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 3 -->
      <div class="criterio">
        <h2>3. Comunica√ß√£o e Relacionamento Interpessoal</h2>
        <em>Crit√©rio: Efetividade na comunica√ß√£o e constru√ß√£o de rela√ß√µes de confian√ßa.</em>
        <div class="pergunta">Consegue estabelecer uma rela√ß√£o de confian√ßa e respeito com os novatos?
          <select id="comunicacao1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Adapta sua comunica√ß√£o para diferentes perfis de novatos?
          <select id="comunicacao2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Gerencia conflitos ou d√∫vidas persistentes de forma eficaz?
          <select id="comunicacao3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Facilita a integra√ß√£o do time, promovendo um ambiente colaborativo?
          <select id="comunicacao4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 4 -->
      <div class="criterio">
        <h2>4. Capacidade de Identificar e Solucionar D√∫vidas e Problemas</h2>
        <em>Crit√©rio: Proatividade em identificar dificuldades e oferecer solu√ß√µes.</em>
        <div class="pergunta">Percebe quando um novato tem dificuldades e interv√©m de forma assertiva?
          <select id="solucao1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Prop√µe solu√ß√µes pr√°ticas para problemas comuns?
          <select id="solucao2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Busca refer√™ncias ou suporte adicional para d√∫vidas mais complexas?
          <select id="solucao3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Demonstra vis√£o preventiva ao antecipar poss√≠veis problemas?
          <select id="solucao4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 5 -->
      <div class="criterio">
        <h2>5. Feedback e Melhoria Cont√≠nua</h2>
        <em>Crit√©rio: Disposi√ß√£o para receber e aplicar feedbacks para aprimoramento constante.</em>
        <div class="pergunta">Solicita feedback regularmente dos novatos e gestores?
          <select id="feedback1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Utiliza feedbacks para ajustar seu m√©todo de ensino?
          <select id="feedback2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Demonstra abertura para reconhecer e melhorar sua abordagem?
          <select id="feedback3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Implementa a√ß√µes concretas com base nos feedbacks recebidos?
          <select id="feedback4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 6 -->
      <div class="criterio">
        <h2>6. Lideran√ßa e Proatividade</h2>
        <em>Crit√©rio: Capacidade de assumir a lideran√ßa quando necess√°rio, motivar a equipe e garantir que os processos ocorram de forma eficiente.</em>
        <div class="pergunta">Assume a responsabilidade e lidera os novos auxiliares com seguran√ßa e autoridade?
          <select id="lideranca1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Demonstra iniciativa para resolver problemas sem depender apenas da gest√£o?
          <select id="lideranca2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Sabe delegar tarefas de forma eficiente, garantindo que todos participem do processo?
          <select id="lideranca3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Consegue manter a equipe focada e motivada durante toda a opera√ß√£o assistida?
          <select id="lideranca4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <!-- Crit√©rio 7 -->
      <div class="criterio">
        <h2>7. Controle emocional e Gest√£o de Estresse</h2>
        <em>Crit√©rio: Capacidade de manter a calma, tomar decis√µes equilibradas e lidar com momentos de press√£o no ambiente hospitalar.</em>
        <div class="pergunta">O auxiliar mant√©m a calma mesmo diante de situa√ß√µes de estresse ou alta demanda?
          <select id="controle1" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Consegue lidar com dificuldades dos novatos sem demonstrar impaci√™ncia ou frustra√ß√£o?
          <select id="controle2" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Controla bem suas emo√ß√µes e evita conflitos desnecess√°rios com as equipes (farm√°cia, enfermagem, TI, etc)?
          <select id="controle3" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
        <div class="pergunta">Mant√©m uma postura profissional e equilibrada, independentemente do cen√°rio?
          <select id="controle4" required><option value="">Selecione</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option></select>
        </div>
      </div>

      <label for="comentarios">Coment√°rios Finais:</label>
      <textarea id="comentarios" rows="4" placeholder="Observa√ß√µes adicionais sobre o desempenho do auxiliar."></textarea>

      <div class="botoes">
        <button type="submit" id="btnGerar">Gerar Relat√≥rio</button>
        <button type="button" id="btnDownload" disabled>Baixar Relat√≥rio em Word</button>
      </div>
    </form>

    <pre id="relatorio"></pre>

    <div class="interpretacao">
      <b>Faixa de Interpreta√ß√£o da Pontua√ß√£o:</b><br>
      18 - 20 pontos: <span style="color:var(--azul-hapvida)">Excelente üåü</span><br>
      15 - 17 pontos: <span style="color:var(--azul-hapvida)">Bom üëç</span><br>
      12 - 14 pontos: <span style="color:var(--laranja-hapvida)">Razo√°vel (precisa melhorar) ‚ö†Ô∏è</span><br>
      10 - 11 pontos: <span style="color:#cf3c00">Fraco (grandes melhorias necess√°rias) üö®</span><br>
      Menos de 10 pontos: <span style="color:#cf3c00">Muito Fraco (n√≠vel cr√≠tico) ‚ùå</span>
    </div>
  </div>

  <script>
    const form = document.getElementById('formAval');
    const relatorioEl = document.getElementById('relatorio');
    const btnDownload = document.getElementById('btnDownload');
    let relatorioGerado = '';
    let nomeColaborador = '';

    const interpretacaoFaixa = (pontos) => {
      if (pontos >= 18) return 'Excelente üåü';
      if (pontos >= 15) return 'Bom üëç';
      if (pontos >= 12) return 'Razo√°vel (precisa melhorar) ‚ö†Ô∏è';
      if (pontos >= 10) return 'Fraco (grandes melhorias necess√°rias) üö®';
      return 'Muito Fraco (n√≠vel cr√≠tico) ‚ùå';
    };

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      nomeColaborador = document.getElementById('nome').value.trim();
      const setor = document.getElementById('setor').value.trim();
      const comentarios = document.getElementById('comentarios').value.trim();

      const somaCrit = (ids) => ids.reduce((acc, id) => acc + parseInt(document.getElementById(id).value), 0);

      const criterios = [
        { nome: 'Dom√≠nio T√©cnico do Sistema e Processos', ids: ['dominio1','dominio2','dominio3','dominio4'] },
        { nome: 'Habilidade de Mentoria e Treinamento', ids: ['mentoria1','mentoria2','mentoria3','mentoria4'] },
        { nome: 'Comunica√ß√£o e Relacionamento Interpessoal', ids: ['comunicacao1','comunicacao2','comunicacao3','comunicacao4'] },
        { nome: 'Capacidade de Identificar e Solucionar D√∫vidas e Problemas', ids: ['solucao1','solucao2','solucao3','solucao4'] },
        { nome: 'Feedback e Melhoria Cont√≠nua', ids: ['feedback1','feedback2','feedback3','feedback4'] },
        { nome: 'Lideran√ßa e Proatividade', ids: ['lideranca1','lideranca2','lideranca3','lideranca4'] },
        { nome: 'Controle emocional e Gest√£o de Estresse', ids: ['controle1','controle2','controle3','controle4'] },
      ];

      let pontuacoes = [];

      criterios.forEach(c => {
        const pontos = somaCrit(c.ids);
        pontuacoes.push({ nome: c.nome, pontos, interpretacao: interpretacaoFaixa(pontos) });
      });

      const pontosFortes = pontuacoes.filter(p => p.pontos >= 18);
      const pontosMelhorar = pontuacoes.filter(p => p.pontos < 15);

      // Monta tabela HTML
      let tabelaHTML = `<table border="1" cellspacing="0" cellpadding="6" style="border-collapse:collapse; font-family: Arial, sans-serif; font-size:14pt; color:#175fc5; width: 100%;">`;
      tabelaHTML += `<thead><tr style="background-color:#eaf1fb;"><th>Crit√©rio</th><th>Pontua√ß√£o</th><th>Interpreta√ß√£o</th></tr></thead><tbody>`;
      pontuacoes.forEach(p => {
        tabelaHTML += `<tr><td>${p.nome}</td><td style="text-align:center;">${p.pontos}</td><td>${p.interpretacao}</td></tr>`;
      });
      tabelaHTML += `</tbody></table>`;

      // Monta o relat√≥rio em HTML
      relatorioGerado = `
        <h1 style="color:#175fc5;">Relat√≥rio de Avalia√ß√£o - Auxiliares de Farm√°cia Hospitalar</h1>
        <p><strong>Nome do Colaborador:</strong> ${nomeColaborador}<br>
        <strong>Setor:</strong> ${setor}</p>
        <h2 style="color:#175fc5;">Resumo da Pontua√ß√£o</h2>
        ${tabelaHTML}
        <h2 style="color:#175fc5;">Principais Pontos Fortes</h2>
        <ul>
          ${pontosFortes.length === 0 ? '<li>Nenhum ponto forte destacado.</li>' : pontosFortes.map(p => `<li>${p.nome}: desempenho excelente que contribui significativamente para o setor.</li>`).join('')}
        </ul>
        <h2 style="color:#175fc5;">Pontos de Aten√ß√£o e Oportunidades de Desenvolvimento</h2>
        <ul>
          ${pontosMelhorar.length === 0 ? '<li>Nenhum ponto cr√≠tico identificado.</li>' : pontosMelhorar.map(p => `<li>${p.nome}: necessita de melhorias para alcan√ßar a excel√™ncia.</li>`).join('')}
        </ul>
        <h2 style="color:#175fc5;">Coment√°rios Finais</h2>
        <p>${comentarios ? comentarios : 'Nenhum coment√°rio adicional.'}</p>
      `;

      relatorioEl.innerHTML = relatorioGerado;
      btnDownload.disabled = false;
    });

    btnDownload.addEventListener('click', () => {
      if (!relatorioGerado) return;

      const header = `
        <html xmlns:o='urn:schemas-microsoft-com:office:office' 
              xmlns:w='urn:schemas-microsoft-com:office:word' 
              xmlns='http://www.w3.org/TR/REC-html40'>
        <head><title>Relat√≥rio de Avalia√ß√£o</title></head><body>`;
      const footer = `</body></html>`;

      const sourceHTML = header + relatorioGerado + footer;

      const blob = new Blob(['\ufeff', sourceHTML], {
        type: 'application/msword'
      });

      const filename = `Relatorio_Avaliacao_${nomeColaborador.replace(/\s+/g, '_') || 'colaborador'}.doc`;

      if (window.navigator && window.navigator.msSaveOrOpenBlob) {
        window.navigator.msSaveOrOpenBlob(blob, filename);
      } else {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => {
          document.body.removeChild(a);
          window.URL.revokeObjectURL(url);
        }, 0);
      }
    });
  </script>
</body>
</html>
